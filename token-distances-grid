// Get origin token
const originToken = canvas.tokens.controlled[0];
if (!originToken) {
    ui.notifications.warn("Please select a token to measure distance from.");
    return;
}

// Compute square-based distance (Chebyshev)
function getGridDistance(a, b) {
    const dx = Math.abs(a.x - b.x) / canvas.grid.size;
    const dy = Math.abs(a.y - b.y) / canvas.grid.size;
    return Math.max(dx, dy); // Treat diagonals as 1 unit like tactical grid movement
}

// Find tokens in range
const tokensInRange = canvas.tokens.placeables.filter(token => {
    if (!token.actor || token === originToken) return false;
    const dist = getGridDistance(originToken.center, token.center);
    console.log(`${token.name}: ${dist} grid squares`);
});

// Notify user
ui.notifications.info(`Open console (F12) to see results.`);
